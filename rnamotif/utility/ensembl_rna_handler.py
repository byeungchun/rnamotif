import os
import logging


def save_one_fasta_from_ensembl_api_return(fileloc, filename, ensembl_res):

    if not os.path.exists(fileloc):
        os.mkdir(fileloc)
    try:
        fasta_file = os.path.join(fileloc, filename)
        print(f'FASTA file: {fasta_file}')
        with open(fasta_file, 'w') as fout:
            for gene in ensembl_res:
                for seq_type in ensembl_res[gene]:
                    if ensembl_res[gene][seq_type]['retsts']:
                        req_url = ensembl_res[gene][seq_type]['requrl']
                        fasta_header = f'{gene} {seq_type.upper()} {req_url}'
                        fout.writelines(f'>{fasta_header}\n')
                        fout.writelines(
                            f'{ensembl_res[gene][seq_type]["retval"]}\n')
    except Exception as ex:
        raise RuntimeError(f'File writining error.\n {ex}')

    return True


if __name__ == "__main__":
    fileloc = os.path.abspath(r'../../samples')
    filename = 'sample1.fasta'
    ensembl_res = {'ENSMUST00000000312': {'cdna': {'retsts': True,
                                                   'requrl': 'https://rest.ensembl.org/sequence/id/ENSMUST00000000312?type=cdna',
                                                   'retval': 'CAGCCTCTGCGCTGCTCACTGGTGTGGGAGCCGCGGCGCACTACTGAGTTCCCAAGAACTTCTGCTAGACTCCTGCCCGGCCTAACCCGGCCCTGCCCGACCGCACCCGAGCTCAGTGTTTGCTCGGCGTCTGCCGGGTCCGCCATGGGAGCCCGGTGCCGCAGCTTTTCCGCGCTCCTGCTCCTGCTGCAGGTCTCCTCATGGCTTTGCCAGGAGCTGGAGCCTGAGTCCTGCAGTCCCGGCTTCAGTTCCGAGGTCTACACCTTCCCGGTGCCGGAGAGGCACCTGGAGAGAGGCCATGTCCTGGGCAGAGTGAGATTTGAAGGATGCACTGGCCGGCCAAGGACAGCCTTCTTTTCGGAAGACTCCCGATTCAAAGTGGCGACAGACGGCACCATCACAGTGAAGCGGCATCTAAAGCTCCACAAGCTGGAGACCAGTTTCCTCGTCCGCGCCCGGGACTCCAGTCATAGGGAGCTGTCTACCAAAGTGACGCTGAAGTCCATGGGGCACCACCATCACCGGCACCACCACCGCGACCCTGCCTCTGAATCCAACCCAGAGCTGCTCATGTTTCCCAGCGTGTACCCAGGTCTCAGAAGACAGAAACGAGACTGGGTCATCCCTCCCATCAGCTGCCCCGAAAATGAAAAGGGCGAATTTCCAAAGAACCTGGTTCAGATCAAATCCAACAGGGACAAAGAAACAAAGGTTTTCTACAGCATCACCGGCCAAGGAGCTGACAAACCCCCCGTTGGCGTTTTCATCATTGAGAGGGAGACAGGCTGGCTGAAAGTGACACAGCCTCTGGATAGAGAAGCCATTGCCAAGTACATCCTCTATTCTCATGCCGTGTCATCAAATGGGGAAGCGGTGGAGGATCCCATGGAGATAGTGATCACAGTGACAGATCAGAATGACAACAGGCCAGAGTTTACCCAGCCGGTCTTTGAGGGATTCGTTGCAGAAGGCGCTGTTCCAGGAACCTCCGTGATGAAGGTCTCAGCCACCGATGCAGACGATGACGTCAACACCTACAACGCTGCCATCGCCTACACCATCGTCAGCCAGGATCCTGAGCTGCCTCACAAAAACATGTTCACTGTCAATAGGGACACCGGGGTCATCAGTGTGCTCACCTCTGGGCTGGACCGAGAGAGTTACCCTACATACACTCTGGTGGTTCAGGCTGCTGACCTTCAAGGTGAAGGCTTGAGCACAACAGCCAAGGCTGTGATCACTGTCAAGGATATTAATGACAACGCTCCTGTCTTCAACCCAAGCACGTATCAGGGTCAAGTGCCTGAGAATGAGGTCAATGCCCGGATCGCCACACTCAAAGTGACCGATGATGATGCCCCCAACACTCCGGCGTGGAAAGCTGTGTACACCGTAGTCAACGATCCTGACCAGCAGTTCGTTGTTGTCACAGACCCCACGACCAATGATGGCATTTTGAAAACAGCCAAGGGCTTGGATTTTGAGGCCAAGCAGCAATACATCCTTCATGTGAGAGTGGAGAACGAGGAACCCTTTGAGGGGTCTCTTGTCCCTTCCACAGCCACTGTCACTGTGGACGTGGTAGACGTGAATGAAGCCCCCATCTTTATGCCTGCGGAGAGGAGAGTCGAAGTGCCCGAAGACTTTGGTGTGGGTCAGGAAATCACATCTTATACCGCTCGAGAGCCGGACACGTTCATGGATCAGAAGATCACGTATCGGATTTGGAGGGACACTGCCAACTGGCTGGAGATTAACCCAGAGACTGGTGCCATTTTCACGCGCGCTGAGATGGACAGAGAAGACGCTGAGCATGTGAAGAACAGCACATATGTAGCTCTCATCATCGCCACAGATGATGGTTCACCCATTGCCACTGGCACGGGCACTCTTCTCCTGGTCCTGTTAGACGTCAATGACAACGCTCCCATCCCAGAACCTCGAAACATGCAGTTCTGCCAGAGGAACCCACAGCCTCATATCATCACCATCTTGGATCCAGACCTTCCCCCCAACACGTCCCCCTTTACTGCTGAGCTAACCCATGGGGCCAGCGTCAACTGGACCATTGAGTATAATGACGCAGCTCAAGAATCTCTCATTTTGCAACCAAGAAAGGACTTAGAGATTGGCGAATACAAAATCCATCTCAAGCTCGCGGATAACCAGAACAAAGACCAGGTGACCACGTTGGACGTCCATGTGTGTGACTGTGAAGGGACGGTCAACAACTGCATGAAGGCGGGAATCGTGGCAGCAGGATTGCAAGTTCCTGCCATCCTCGGAATCCTTGGAGGGATCCTCGCCCTGCTGATTCTGATCCTGCTGCTCCTACTGTTTCTACGGAGGAGAACGGTGGTCAAAGAGCCCCTGCTGCCACCAGATGATGATACCCGGGACAATGTGTATTACTATGATGAAGAAGGAGGTGGAGAAGAAGACCAGGACTTTGATTTGAGCCAGCTGCACAGGGGCCTGGATGCCCGACCGGAAGTGACTCGAAATGATGTGGCTCCCACCCTCATGAGCGTGCCCCAGTATCGTCCCCGTCCTGCCAATCCTGATGAAATTGGAAACTTCATCGATGAAAACCTGAAGGCAGCCGACAGCGACCCCACGGCACCCCCTTACGACTCTCTGTTGGTGTTCGATTACGAGGGCAGTGGTTCTGAAGCCGCTAGCCTGAGCTCACTGAACTCCTCTGAGTCGGATCAGGACCAGGACTACGATTATCTGAACGAGTGGGGCAACCGATTCAAGAAGCTGGCGGACATGTACGGCGGTGGTGAGGACGACTAGGGGACTAGCAAGTCTCCCCCGTGTGGCACCATGGGAGATGCAGAATAATTATATCAGTGGTCTTTCAGCTCCTTCCCTGAGTGTGTAGAAGAGAGACTGATCTGAGAAGTGTGCAGATTGCATAGTGGTCTCACTCTCCCTACTGGACTGTCTGTGTTAGGATGGTTTTCACTGATTGTTGAAATCTTTTTTTATTTTTTATTTTTACAGTGCTGAGATATAAACTGTGCCTTTTTTTGTTTGTTTGTTTCTGTTTTTGTTCTTTTGAGCTATGATCTGCCCCAGACACAACAGCCCCAAGCCCCTCACACCTCACTAATTTTTTACATTGTGTACTTGCCCTCAATTACCATGTTTGCTGTATTCTAATAGTCACTCATGTTCCTGAATTCTGTTGCCCTGCCCAGGTGATATTCTAGGATGCAGAAATGCCTGGGCCCTTTTATGGTGAGAGACAGGTATCTTGGTGTGGGTGCAACTGCGCTGGATAGTGTGTGTGTTCCCAAGATCTTTCGTGGTATTCCCTCTCCACCTCCAGAGAACTCATTTACAGTGGCATTCCTTGTTCGGCTATGTGTCTGGGGCAGAACAAAAAAAAGGGACCACTATGCATGCTGCACACGTCTCAGATTCTTAGGTACACACCTGATTCTTAGGTGCATGCCATAGTGGGATATGTTGCTTTGATCAGAACCTGCAGGGAGGTTTTCGGGCACCACTTAAGTTTCTTGGCGTTTCTTTCAAACCAAAACTAAAGAATGGTTGTTCTCTGAGAGAGACTGGAGTGCCACCACCAAAGACAGAGGAGAGAAAAGGAGAGAAACCAAACTTGGGGACAGCAACATCAGCGAACCCGGCTAGTTGGCACACCGATGGTGAGGGTACACAGGCGGTGAGACCTATCCCACAAGATTTCTGGAAGACTAGGCTTATCTCAACCAATGTTTTCTGGCTGGAATCTTTGTCCATGTATTCCTGAAGCCCAGGAAATGCACCCCTCCAATGCCTGCTCTTGATGGTAGCTACAGAAAATGCTGGCCGATTTAAACCCAAGTTGCCCAGTTCTGAGTAGAAAACTGAGACTATGCTGTGTGTGGCGGCGCGCACCTTTAAGCCCAGCACTCAGGAGGCAGAGGCAGTCAGATCTCCCTGAGTTCGAGGCCAACCTGGTATATATAGTATAGTAAGCGAATTCTAGGACAGCCAGGGCTACACAGAGAAACCCTGTCTCTGCAAACCAAAAGAGAAAACTGAGAATATTACAAATTGTGCATTTTCTCAGGAAGCAGGAAGAGAACATTCTAACGGGAAAAAGGAGACAAGACCTTTGAGAGTTTTCATTCAAAATGCAAATCTCAGCTTTTTGATAACCACTGGAAAGAATTTTATTGAAAGTTCTGTACTTACCTAACTTTGGAAGAAAATGATGACCACAATCAACTGTGAGAACTGTTGATTTCTCTGTAGTTTAATCATGTAATGTTGCTAGAGTGACCTTTGTATGTAGTTTGAGTGTATGTGTGTGGGTGCTGATAATTTTGTATTTTGTGGGGGGTGGAAAAGGTAAGCCATTGAAACCGTTCTCTAAGATGCATTTTTATGAATTTTATTAAAGAGTTTTGTTAAACTGT'}},
                   'ENSMUST00000018186': {'cdna': {'retsts': True,
                                                   'requrl': 'https://rest.ensembl.org/sequence/id/ENSMUST00000018186?type=cdna',
                                                   'retval': 'CCTGAACTCTGTAGCCAGCGGTGTTGGCAACACGCCCCGTGAGCGGGTAGAGCCCTGGCCAGCACAATCAGCTCCGGCAGGCTCCCAGGACCGAAGGCTCAGGATTTGAGAGCCCATCACGGGGGCGACATCTTGTTCTCTTCACCAGGACAAAACAGGCCCAGAAGCCACAAGCTACCTCCCGAAGCCACACAGAGGCGCCACAGTAGCCAGTCTCTCGCCGAGCCTCTTCCGTGCAGCGCCGTCAGCCACTCAGCGCGCACTCCCGTCTTCACAAGCGGAAGTGGGCGGGGACACTGGGAGTCTCCGCCCCCTATCCGCCCACCTCCGCGCTCCTGACTGGCTCCGCAGGGCGTCCCCGCCTCCGAGGTGTTGAGACCGAGGCGGGTTGTTGGGGGAGCGGCCGGCTGAGTAGCGGGTGTAGAACCGTGCGTGAGGCCACCGTCTCTTCTTCGCCACCATGGGGGCCCAGCTGAGCACGTTGAGCCACGTGGTGCTCTCGCCCGTCTGGTTCATCTACAGTCTCTTCATGAAGCTGTTTCAGCGCTCCACACCGGCCATCACCCTCGAGAACCCCGACATCAAGTACCCTCTGAGGCTCATCGACAAGGAGGTCATCAGTCCTGACACTCGGCGCTTCCGATTTGCCCTCCCTTCACCCCAGCACATCCTGGGCCTTCCTATTGGCCAACACATCTACCTCTCGACTAGGATCGATGGCAACTTGGTCATTCGGCCCTACACCCCTGTGTCGAGCGATGATGACAAGGGCTTTGTGGACTTGGTGGTCAAGGTTTACTTCAAGGACACCCATCCCAAGTTTCCAGCTGGAGGGAAAATGTCTCAGTACCTGGAAAACATGAAGATTGGAGACACCATTGAATTCCGGGGTCCCAATGGGCTACTGGTCTACCAGGGCAAAGGGAAGTTTGCCATCCGTGCAGACAAGAAGTCCAACCCCGTTGTCAGGACGGTGAAGTCTGTAGGCATGATTGCAGGAGGGACAGGCATCACCCCAATGCTGCAGGTGATCCGAGCCGTCCTGAAGGACCCAAACGACCACACCGTGTGCTATCTGCTCTTTGCCAACCAGTCCGAGAAAGATATCCTGTTGCGGCCTGAGCTGGAGGAACTGAGGAACGAACATTCTGCTCGCTTCAAGCTCTGGTACACAGTGGACAAAGCCCCTGATGCCTGGGACTATAGCCAGGGCTTCGTGAATGAGGAGATGATCAGGGACCACCTTCCAACTCCTGGGGAGGAGCCGCTGATACTGATGTGTGGACCCCCACCAATGATCCAGTTTGCCTGTTTGCCAAACCTGGAGCGTGTGGGCCATCCCAAGGAGCGATGCTTCACCTTCTGATGGCTGGACGCTGGCCAAGCCTGTGCCTGCTGCTCACGCACTCACCACAACCACCTGTCCACCCCTTCCTTCCCCACCACTGTCGCTCACCCTGACATATGCCCACATCCATGCTGGGGCCTGGGTTCAGCCTGGCCTGCCCAGCCCTGGTCATCCAGCTGTACTGGCCCCTGGGGGGCCCCTTTGGGAGCAGGCCTGTGTATCAGGTGACTTCTGTTGACCACTCTCTGAATAGGCTTCTGTCTGGTACTAACTGGCCATTACCAGAGATGTCCTGTGACTACCCCCTTACACATAGACACACACACACACACACACACACACACAGAGACAGGAGAGAGAGAGAGAGAGAGAGAGAGAGAGGAGAGAGAGGAGAGAGAGAGAGGAGAGAGAGACAGGAGAGAGAGAGAGGAGAGAGAAGAGGAAGAGAGAGAGAGAGAGAGGGAGAGAGAGGAGAGAGAGAGGAGAGAGAGAGAGAAGAGGAAGAGAGAGGGAGGGAGAGCGTGAGCGTGAGCTGTCAGTACCATGTCTACCCATTGCCATGAACTGTGGTCTATAGAAAGGAAGTGAAAGGTAAATAGTCACCTACGGTCCTAGGAACCATGCCTGCCACCTAACCACCTACCTGCCTTAGGCCATAGCCTGGCCTGTGCCCCTAAACACTACATTAGACAGTGACACCCAAAGGTTTTCTTAGGAGGGTGTCTGGCAGAGACAGGCCAGCCCCCACTTGCTGGCCAGGGGTCCCTTGGGGCAGCACGTGGACCCTTCCAAAACTATACACACTGCCCCCGACTCCATGCAGTCTTGAGTGCCCTAAGTTGTCAGCCCAACAGAGTTTGGTAGACCTTGGGGGTCCCTGGCTTATCTCTCCACCCCAAACCTCCTTCCTGTCTGGTCCCCAGCCTGGGGGGGTTCTGAGCAGTGCCTCTTGTCTTGGAGACAGACCTGGTGCCTGGCGCTGCCTTCAGCAGGCAGCAGGCAGCCTCCTGCACACTGGCTTTTTTAGTCATTTATGGGCAAAAAGAGTTAAAGTAAAACTTTGCAAATCCCGAC'}}}
    save_one_fasta_from_ensembl_api_return(fileloc, filename, ensembl_res)
